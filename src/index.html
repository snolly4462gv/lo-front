<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Маршруты ЛО</title>
  <base href="/">

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="icon" type="image/x-icon" href="favicon.ico">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
</head>
<body>
  <app-root></app-root>
</body>

<script async defer src="https://apis.google.com/js/api.js"
      onload="this.onload=function(){};handleClientLoad()"
      onreadystatechange="if (this.readyState === 'complete') this.onload()">
    </script>

<script>

      var apiKey = 'AIzaSyDY0-Eh_aXzIaR7q-wYWOLaSZcr6VRUMkM';
      var discoveryDocs = ["https://people.googleapis.com/$discovery/rest?version=v1"];
      var clientId = '414953430855-irjvuepra9g5imes8ai06c4nqs0tt9cp.apps.googleusercontent.com';
      var scopes = 'profile';


      function handleClientLoad() {
        gapi.load('client:auth2', initClient);
      }
      function initClient() {
          console.log(`INIT`);
        gapi.client.init({
            apiKey: apiKey,
            discoveryDocs: discoveryDocs,
            clientId: clientId,
            scope: scopes,
            response_type: 'code',
            redirect_url: 'betrip.io'
        }).then(function () {
            console.log(`After INIT`);
          gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);
          updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
        });
      }
      function updateSigninStatus(isSignedIn) {
        if (isSignedIn) {
            console.log(`SignedIn`);
            makeApiCall();
        } else {
                 console.log(`NOT SignedIn`);
        }
      }
      // function handleAuthClick(event) {
      //   gapi.auth2.getAuthInstance().signIn();
      //    console.log(`Sign In`);
      // }
      // function handleSignoutClick(event) {
      //   gapi.auth2.getAuthInstance().signOut();
      // }

    //   function makeApiCall() {
    //       console.log(`API CALL`);
    //       var access_token = '';
    //     try{
    //       access_token = gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token;
    //     } catch {
    //         console.log(`no gapi`);
    //     }
    //     if(access_token)
    //       googleLogin(access_token);
    //   }

    // makeApiCall();
</script>


</html>
