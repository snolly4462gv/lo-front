<agm-map #agmMap [latitude]="NewPlace.lat?NewPlace.lat:lat" [longitude]="NewPlace.lng?NewPlace.lng:lng" (mapClick)="MapClick($event)">

  <ng-container *ngIf="Mode != Modes.OnlyMap">
    <ng-container *ngFor="let item of Places; let i = index">
      <agm-snazzy-info-window
        *ngIf="item.lat && item.lng && item.name"
        [isOpen]="true"
        [latitude]="item.lat"
        [longitude]="item.lng"
        [showCloseButton]="false"
        [padding]="'3px'"
        [borderRadius]="'5px'"
        [closeOnMapClick] = "false"
        [backgroundColor]="item.selected?'#FFA901':'#ffffff'"
      >
        <ng-template>
          <!-- src="../../../../../assets/images/map-img.png" -->
          <p *ngIf="!item.image_id" (click)="SelectInfoWindow(i)">{{item.name}}</p>
          <img *ngIf="item.image_id" class="map-img" (click)="SelectInfoWindow(i)" (error)="item.image_id = null" [src]="GetImageURL(item.image_id)" alt="">
        </ng-template>
      </agm-snazzy-info-window>

      <ng-container *ngIf="Mode == Modes.AddPlace && NewPlace.lat && NewPlace.lng">
        <agm-marker
          *ngIf="item.lat && item.lng"
          [latitude]="NewPlace.lat"
          [longitude]="NewPlace.lng"
          [iconUrl]="'../../../../../assets/images/betrip-cursor.svg'"
        ></agm-marker>
      </ng-container>
    </ng-container>


    <ng-container *ngIf="Mode == Modes.CreateRoute">
      <agm-polyline
        *ngFor="let line of Polylines; let i = index"
        [strokeColor]="'#3A1B5A'"
      >
        <agm-polyline-point
          [latitude]="line.start.x"
          [longitude]="line.start.y">
        </agm-polyline-point>
        <agm-polyline-point
          [latitude]="line.end.x"
          [longitude]="line.end.y">
        </agm-polyline-point>
      </agm-polyline>
    </ng-container>
  </ng-container>

</agm-map>
